---
title: "Analyse des determinants macroeconomique du deficit public en France"
author: "KINDBEITER Arnaud, HOBBALLAH Rayan, ZELLER Emile"
date: "2024-12-08"
output:
  pdf_document:
    latex_engine: xelatex
    keep_tex: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  fig.path = "figures/",
  dev = "png",
  dpi = 300,
  fig.align = "center"
)
library(readr)
library(car)
library(AER)
library(lmtest)
library(sandwich)
library(olsrr)
library(corrplot)
library(MASS)
library(stargazer)
library(ggplot2)
rm(list = ls())

# Reduire la longueur des titres de graphiques
options(width = 60)
par(mar = c(4, 4, 2, 1))
```

## Introduction

Le deficit public en France est influence par divers facteurs macroeconomiques. L'objectif de cette analyse est de comprendre quels sont les principaux determinants qui influencent le deficit public au cours des 20 dernieres annees. Les variables etudiees incluent le taux de chomage, le taux d'epargne des menages, le taux d'inflation, le taux de change effectif, les recettes fiscales nettes et le PIB.

## Description des variables

Les donnees utilisees pour cette analyse proviennent d'Eurostat. Ces donnees couvrent plusieurs indicateurs economiques essentiels pour comprendre l'impact de la crise sanitaire sur les parametres macroeconomiques.

- Government.surplus.or.deficit : Deficit/excedent public
- NetTaxReceipts : Total des recettes provenant des impots et des cotisations sociales
- Unemployment.Rate : Taux de chomage (trimestriel, agrege en annuel pour notre etude)
- effective.exchange.rate : Taux de change effectifs des pays industrialises 
- Household.saving.rate : Taux d'epargne brut des menages 
- InflationRate : Indice des prix a la consommation harmonise
- GDP : PIB et principales composantes (production, depenses et revenus)
- year : Les differentes annees etudiees

## Preparation des donnees

On creer un data frame avec les donnees qui seront utiliser dans notre modele.

```{r data_prep}
data <- data.frame(
  effective.exchange.rate = c(100.23875, 100.23489, 100.22141, 100.19603, 100.11817, 100.04099, 100.00065, 100.00136, 100.00070, 99.99810, 99.99955, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000, 100.0000),
  Household.saving.rate = c(14.34, 14.45, 13.71, 14.05, 14.41, 14.38, 15.73, 15.43, 15.05, 15.19, 13.87, 14.15, 13.61, 13.41, 13.67, 13.54, 14.24, 20.03, 18.67, 16.46, 16.52),
  InflationRate = c(1, 2.9, 1.9, 2.7, 2.5, 0.4, -2.8, 2, 2.4, 0.2, 0.8, 1, 1.1, 0.9, 2.1, 1.6, 2, -7.4, 6.9, 2.6, 0.9),
  Unemployment.Rate = c(8.500, 8.875, 8.875, 8.850, 8.025, 7.425, 9.125, 9.275, 9.225, 9.775, 10.275, 10.250, 10.375, 10.075, 9.425, 9.025, 8.425, 8.025, 7.900, 7.350, 7.350),
  Government.surplus.or.deficit = c(-4.1, -3.6, -3.5, -2.7, -3.0, -3.5, -7.4, -7.2, -5.3, -5.2, -4.9, -4.6, -3.9, -3.8, -3.4, -2.3, -2.4, -8.9, -6.6, -4.7, -5.5),
  NetTaxReceipts = c(44.3, 44.4, 44.7, 45.1, 44.6, 44.5, 44.1, 44.2, 45.3, 46.5, 47.4, 47.6, 47.7, 47.7, 48.5, 48.3, 47.3, 47.4, 46.9, 47.6, 45.6),
  GDP = c(2.18, 2.35, 1.9, 1.89, 1.6, 3.17, 0.11, 1.7, 2.3, 2.23, 0.99, 0.62, 0.08, 0.31, 1.17, 2.1, 1.31, 0.54, 2.08, 5.9, 5.7),
  year = c(2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023)
)
```

```{r data_frame, echo=FALSE}
mon_data_frame <- data.frame(
  year = data$year,
  effective.exchange.rate = data$effective.exchange.rate,
  Household.saving.rate = data$Household.saving.rate, 
  InflationRate = data$InflationRate,
  Unemployment.Rate = data$Unemployment.Rate,
  NetTaxReceipts = data$NetTaxReceipts,
  GDP = data$GDP,
  Government.surplus.or.deficit = data$Government.surplus.or.deficit
)
```

On visualise la base de donnees afin de verifier qu'il ne manque pas de valeurs.

```{r show_data}
mon_data_frame
```

## Analyse preliminaire

Les statistiques descriptives nous offrent un apercu global des caracteristiques des variables de notre modele.

```{r summary_stats}
summary(mon_data_frame)
```

### Visualisation des tendances au fil des annees

```{r plot_deficit, warning=FALSE, message=FALSE, fig.width=6.5, fig.height=4, out.width="90%"}
ggplot(mon_data_frame, aes(x = year, y = Government.surplus.or.deficit)) +
  geom_line(color = "blue", linewidth = 1) +
  labs(
    title = "Evolution du deficit public en France",
    x = "Annee",
    y = "Deficit public (pourcent du PIB)"
  ) +
  theme_minimal()
```

Le graphique montre des fluctuations marquees du deficit public en France, avec un creux notable en 2009, du a la crise financiere mondiale. Apres un redressement progressif jusqu'en 2019, le deficit s'aggrave brutalement en 2020 en raison de la crise du COVID-19, atteignant pres de 10 pourcent du PIB.

### Matrice de correlation

```{r correlation_matrix}
cor_matrix <- cor(data[, c("Unemployment.Rate", "Household.saving.rate", "effective.exchange.rate", "NetTaxReceipts", "InflationRate", "GDP")])
```

```{r plot_correlation, echo=FALSE, fig.width=6.5, fig.height=6, out.width="90%"}
corrplot(cor_matrix, method = "color", type = "upper", 
         tl.col = "black", tl.srt = 45, 
         col = colorRampPalette(c("blue", "white", "red"))(200))
```

## Estimation du modele de regression

Pour estimer l'impact des determinants macroeconomiques sur le deficit public, nous avons utilise un modele de regression lineaire multiple.

```{r model_estimation}
model <- lm(Government.surplus.or.deficit ~ Unemployment.Rate + 
              Household.saving.rate + effective.exchange.rate + 
              NetTaxReceipts + GDP + InflationRate, data = data)
```

```{r model_summary, echo=FALSE}
summary(model)
```

### Analyse des resultats du modele de regression

Le coefficient du taux de chomage est negatif et significatif (p-value = 8.75e-05), ce qui suggere qu'une augmentation du taux de chomage de 1 point entraine une reduction du deficit public de 1.10 pourcent du PIB, ceteris paribus.

Le coefficient du taux d'epargne des menages est egalement negatif et fortement significatif (p-value = 2.19e-08). Cela implique qu'une augmentation du taux d'epargne des menages de 1 point est associee a une reduction du deficit public de 0.997 pourcent du PIB.

Le coefficient du taux de change effectif est positif et significatif (p-value = 0.00598). Une appreciation de la monnaie de 1 point entraine une augmentation du deficit public de 5.26 pourcent du PIB.

Le coefficient des recettes fiscales nettes est positif et significatif (p-value = 5.13e-05). Une augmentation des recettes fiscales nettes de 1 point est associee a une augmentation du deficit public de 0.52 pourcent du PIB.

Le coefficient du PIB est negatif, mais non significatif (p-value = 0.21112). L'impact du PIB sur le deficit public pourrait etre negligeable dans ce modele.

Le coefficient du taux d'inflation est positif et significatif (p-value = 0.04666). Une augmentation du taux d'inflation de 1 point est associee a une augmentation du deficit public de 0.10 pourcent du PIB.

### R-carre ajuste et Test F

Le R-carre ajuste du modele est de 0.9246, indiquant que 92.46 pourcent de la variabilite du deficit public est expliquee par les variables incluses dans le modele.

Le test F du modele est de 41.89 avec une p-value de 3.729e-08, ce qui est extremement faible. Les variables selectionnees ont un impact globalement significatif sur le deficit public.

## Tests de diagnostic

### Test de multicolinearite

```{r vif_test}
vif_values <- vif(model)
print(vif_values)
```

Toutes les valeurs VIF sont bien inferieures a 5, donc pas de multicolinearite importante.

### Test d'heteroscedasticite

```{r bp_test}
bptest(model)
```

La p-value obtenue (0.8294) est bien superieure au seuil de 5 pourcent. Les residus du modele sont homoscedastes.

### Reset test de Ramsey

```{r reset_test}
resettest(model)
```

La p-value de 0.9669 suggere que le modele est correctement specifie.

### Analyse des residus

#### Residus vs valeurs ajustees

```{r residuals_plot1, fig.width=6.5, fig.height=5, out.width="90%", fig.pos="H"}
par(mar = c(4, 4, 2, 1))
plot(model, which = 1) 
```

Les residus sont repartis de maniere aleatoire autour de zero, ce qui suggere que le modele est bien specifie.

#### QQ-plot des residus

```{r residuals_plot2, fig.width=6.5, fig.height=5, out.width="90%", fig.pos="H"}
par(mar = c(4, 4, 2, 1))
plot(model, which = 2) 
```

Les points suivent une droite diagonale, ce qui suggere que les residus sont normalement distribues.

#### Test de normalite des residus

```{r shapiro_test}
shapiro.test(residuals(model))
```

La p-value de 0.849 indique que les residus sont normalement distribues.

#### Autocorrelation des residus

```{r dw_test}
dwtest(model)
```

Pas de probleme d'autocorrelation detecte.

## Limites du modele

Notre modele presente plusieurs limites. Il repose sur un echantillon de seulement 20 observations, ce qui limite la robustesse des resultats. Nous avons suppose des relations lineaires entre les variables, ce qui peut ne pas refleter la realite. D'autres elements importants, comme les politiques budgetaires ou des evenements imprevus, n'ont pas ete pris en compte.

## Graphiques supplementaires

```{r plot_unemployment, warning=FALSE, message=FALSE, fig.width=6.5, fig.height=4, out.width="90%"}
ggplot(data, aes(x = Unemployment.Rate, y = Government.surplus.or.deficit)) +
  geom_point(color = "blue") +
  geom_smooth(method = "lm", color = "red") +
  theme_minimal() +
  labs(
    title = "Relation entre le taux de chomage et le deficit gouvernemental",
    x = "Taux de chomage (pourcent)",
    y = "Deficit gouvernemental (pourcent)"
  )
```

```{r plot_gdp, warning=FALSE, message=FALSE, fig.width=6.5, fig.height=4, out.width="90%"}
par(mar = c(4, 4, 2, 1))
plot(
  data$GDP,
  data$Government.surplus.or.deficit,
  main = "Relation entre le PIB et le deficit gouvernemental",
  xlab = "PIB",
  ylab = "Deficit gouvernemental",
  pch = 16,
  col = "red"
)
```